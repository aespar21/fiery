<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate a New App Object — Fire • fiery</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generate a New App Object — Fire" />
<meta property="og:description" content="The Fire generator creates a new Fire-object, which is the class containing
all the app logic. The class is based on the R6 OO-system and
is thus reference-based with methods and data attached to each object, in
contrast to the more well known S3 and S4 systems. A fiery server is event
driven, which means that it is build up and manipulated by adding event
handlers and triggering events. To learn more about the fiery event model,
read the event vignette.
fiery servers can be modified directly or by attaching plugins. As with
events, plugins has its own vignette." />
<meta property="og:image" content="https://fiery.data-imaginist.com/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fiery</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/events.html">The event cycle</a>
    </li>
    <li>
      <a href="../articles/delayed.html">Delaying code execution</a>
    </li>
    <li>
      <a href="../articles/plugins.html">Creating and using plugins</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Demos</li>
    <li>
      <a href="https://www.data-imaginist.com/2017/setting-fire-to-deployment/">Fiery on Heroku</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.data-imaginist.com/2017/when-a-fire-starts-to-burn/">Version 1.0.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://reqres.data-imaginist.com">reqres</a>
</li>
<li>
  <a href="https://routr.data-imaginist.com">routr</a>
</li>
<li>
  <a href="https://github.com/thomasp85/fiery">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate a New App Object</h1>
    <small class="dont-index">Source: <a href='https://github.com/thomasp85/fiery/blob/master/R/Fire.R'><code>R/Fire.R</code></a></small>
    <div class="hidden name"><code>Fire.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Fire generator creates a new <code>Fire</code>-object, which is the class containing
all the app logic. The class is based on the <a href='https://rdrr.io/pkg/R6/man/R6Class.html'>R6</a> OO-system and
is thus reference-based with methods and data attached to each object, in
contrast to the more well known S3 and S4 systems. A <code>fiery</code> server is event
driven, which means that it is build up and manipulated by adding event
handlers and triggering events. To learn more about the <code>fiery</code> event model,
read the <a href='https://fiery.data-imaginist.com/articles/events.html'>event vignette</a>.
<code>fiery</code> servers can be modified directly or by attaching plugins. As with
events, <a href='https://fiery.data-imaginist.com/articles/plugins.html'>plugins has its own vignette</a>.</p>
    </div>



    <h2 class="hasAnchor" id="initialization"><a class="anchor" href="#initialization"></a>Initialization</h2>

    

<p>A new 'Fire'-object is initialized using the <code>new()</code> method on the generator:</p>
<p><strong>Usage</strong></p><table class='table'>
<tr><td><code>app &lt;- Fire$new(host = '127.0.0.1', port = 8080L)</code></td></tr>
</table>


<p><strong>Arguments</strong></p><table class='table'>
<tr><td><code>host</code></td><td></td><td>A string overriding the default host (see the <em>Fields</em> section below)</td></tr>
<tr><td><code>port</code></td><td></td><td>An integer overriding the default port (see the <em>Fields</em> section below)</td></tr>
</table>


<p><em>Copying</em></p>
<p>As <code>Fire</code> objects are using reference semantics new copies of an app cannot
be made simply be assigning it to a new variable. If a true copy of a <code>Fire</code>
object is desired, use the <code>clone()</code> method.</p>
    <h2 class="hasAnchor" id="fields"><a class="anchor" href="#fields"></a>Fields</h2>

    

<dl class='dl-horizontal'>
<dt><code>host</code></dt><dd><p>A string giving a valid IPv4 address owned by the server, or <code>'0.0.0.0'</code> to listen on all addresses. The default is <code>'127.0.0.1'</code></p></dd>
<dt><code>port</code></dt><dd><p>An integer giving the port number the server should listen on (defaults to <code>8080L</code>)</p></dd>
<dt><code>refresh_rate</code></dt><dd><p>The interval in seconds between run cycles when running a blocking server (defaults to <code>0.001</code>)</p></dd>
<dt><code>refresh_rate_nb</code></dt><dd><p>The interval in seconds between run cycles when running a non-bocking server (defaults to <code>1</code>)</p></dd>
<dt><code>trigger_dir</code></dt><dd><p>A valid folder where trigger files can be put when running a blocking server (defaults to <code>NULL</code>)</p></dd>
<dt><code>plugins</code></dt><dd><p>A named list of the already attached plugins. <strong>Static</strong> - can only be modified using the <code><a href='https://rdrr.io/r/base/attach.html'>attach()</a></code> method.</p></dd>
<dt><code>root</code></dt><dd><p>The location of the app. Setting this will remove the root value from requests (or decline them with <code>400</code> if the request does not match the root). E.g. the path of a request will be changed from <code>/demo/test</code> to <code>/test</code> if <code>root == '/demo'</code></p></dd>
<dt><code>access_log_format</code></dt><dd><p>A <a href='https://rdrr.io/pkg/glue/man/glue.html'>glue</a> string defining how requests will be logged. For standard formats see <a href='loggers.html'>common_log_format</a> and <a href='loggers.html'>combined_log_format</a>. Defaults to the <em>Common Log Format</em></p></dd>

</dl>

    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    

<dl class='dl-horizontal'>
<dt><code>ignite(block = TRUE, showcase = FALSE, ...)</code></dt><dd><p>Begins the server, either blocking the console if <code>block = TRUE</code> or not. If <code>showcase = TRUE</code> a browser window is opened directing at the server address. <code>...</code> will be redirected to the <code>start</code> handler(s)</p></dd>
<dt><code><a href='https://rdrr.io/r/stats/start.html'>start(block = TRUE, showcase = FALSE, ...)</a></code></dt><dd><p>A less dramatic synonym of for <code>ignite()</code></p></dd>
<dt><code>reignite(block = TRUE, showcase = FALSE, ...)</code></dt><dd><p>As <code>ignite</code> but additionally triggers the <code>resume</code> event after the <code>start</code> event</p></dd>
<dt><code>resume(block = TRUE, showcase = FALSE, ...)</code></dt><dd><p>Another less dramatic synonym, this time for <code>reignite()</code></p></dd>
<dt><code>extinguish()</code></dt><dd><p>Stops a running server</p></dd>
<dt><code><a href='https://rdrr.io/r/base/stop.html'>stop()</a></code></dt><dd><p>Boring synonym for <code>extinguish()</code></p></dd>
<dt><code>is_running()</code></dt><dd><p>Check if the server is currently running</p></dd>
<dt><code>on(event, handler, pos = NULL)</code></dt><dd><p>Add a <code>handler</code> function to to an <code>event</code> at the given position (<code>pos</code>) in the handler stack. Returns a string uniquely identifying the handler. See the <a href='https://fiery.data-imaginist.com/articles/events.html'>event vignette</a> for more information.</p></dd>
<dt><code>off(handlerId)</code></dt><dd><p>Remove the handler tied to the given <code>id</code></p></dd>
<dt><code>trigger(event, ...)</code></dt><dd><p>Triggers an <code>event</code> passing the additional arguments to the potential handlers</p></dd>
<dt><code>send(message, id)</code></dt><dd><p>Sends a websocket <code>message</code> to the client with the given <code>id</code>, or to all connected clients if <code>id</code> is missing</p></dd>
<dt><code><a href='https://rdrr.io/r/base/Log.html'>log(event, message, request, ...)</a></code></dt><dd><p>Send a <code>message</code> to the logger. The <code>event</code> defines the type of message you are passing on, while <code>request</code> is the related <code>Request</code> object if applicable.</p></dd>
<dt><code>close_ws_con(id)</code></dt><dd><p>Closes the websocket connection started from the client with the given <code>id</code>, firing the <code>websocket-closed</code> event</p></dd>
<dt><code><a href='https://rdrr.io/r/base/attach.html'>attach(plugin, ..., force = FALSE)</a></code></dt><dd><p>Attaches a <code>plugin</code> to the server. See the <a href='https://fiery.data-imaginist.com/articles/plugins.html'>plugin vignette</a> for more information. Plugins can only get attached once unless <code>force = TRUE</code></p></dd>
<dt><code>has_plugin(name)</code></dt><dd><p>Check whether a plugin with the given <code>name</code> has been attached</p></dd>
<dt><code>header(name, value)</code></dt><dd><p>Add a global <code>header</code> to the server that will be set on all responses. Remove by setting <code>value = NULL</code></p></dd>
<dt><code>set_data(name, value)</code></dt><dd><p>Adds data to the servers internal data store</p></dd>
<dt><code>get_data(name)</code></dt><dd><p>Extracts data from the internal data store</p></dd>
<dt><code>remove_data(name)</code></dt><dd><p>Removes the data with the given <code>name</code> from the internal data store</p></dd>
<dt><code><a href='https://rdrr.io/r/stats/time.html'>time(expr, then, after, loop = FALSE)</a></code></dt><dd><p>Add a timed evaluation (<code>expr</code>) that will be evaluated after the given number of seconds (<code>after</code>), potentially repeating if <code>loop = TRUE</code>. After the expression has evaluated the <code>then</code> function will get called with the result of the expression and the server object as arguments.</p></dd>
<dt><code>remove_time(id)</code></dt><dd><p>Removes the timed evaluation identified by the <code>id</code> (returned when adding the evaluation)</p></dd>
<dt><code><a href='https://rdrr.io/r/base/base-defunct.html'>delay(expr, then)</a></code></dt><dd><p>Similar to <code><a href='https://rdrr.io/r/stats/time.html'>time()</a></code>, except the <code>expr</code> is evaluated immediately at the end of the loop cycle (<a href='https://fiery.data-imaginist.com/articles/delayed.html'>see here</a> for detailed explanation of delayed evaluation in fiery).</p></dd>
<dt><code>remove_delay(id)</code></dt><dd><p>Removes the delayed evaluation identified by the <code>id</code></p></dd>
<dt><code>async(expr, then)</code></dt><dd><p>As <code><a href='https://rdrr.io/r/base/base-defunct.html'>delay()</a></code> and <code><a href='https://rdrr.io/r/stats/time.html'>time()</a></code> except the expression is evaluated asynchronously. The progress of evaluation is checked at the end of each loop cycle</p></dd>
<dt><code>remove_async(id)</code></dt><dd><p>Removes the async evaluation identified by the <code>id</code>. The evaluation is not necessarily stopped but the then function will not get called.</p></dd>
<dt><code>set_client_id_converter(converter)</code></dt><dd><p>Sets the function that converts an HTTP request into a specific client id</p></dd>
<dt><code>set_logger(logger)</code></dt><dd><p>Sets the function that takes care of logging</p></dd>
<dt><code>set_client_id_converter(converter)</code></dt><dd><p>Sets the function that converts an HTTP request into a specific client id</p></dd>
<dt><code>clone()</code></dt><dd><p>Create a copy of the full <code>Fire</code> object and return that</p></dd>

</dl>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Create a New App</span>
<span class='no'>app</span> <span class='kw'>&lt;-</span> <span class='no'>Fire</span>$<span class='fu'>new</span>(<span class='kw'>port</span> <span class='kw'>=</span> <span class='fl'>4689</span>)

<span class='co'># Setup the data every time it starts</span>
<span class='no'>app</span>$<span class='fu'>on</span>(<span class='st'>'start'</span>, <span class='kw'>function</span>(<span class='no'>server</span>, <span class='no'>...</span>) {
    <span class='no'>server</span>$<span class='fu'>set_data</span>(<span class='st'>'visits'</span>, <span class='fl'>0</span>)
    <span class='no'>server</span>$<span class='fu'>set_data</span>(<span class='st'>'cycles'</span>, <span class='fl'>0</span>)
})

<span class='co'># Count the number of cycles</span>
<span class='no'>app</span>$<span class='fu'>on</span>(<span class='st'>'cycle-start'</span>, <span class='kw'>function</span>(<span class='no'>server</span>, <span class='no'>...</span>) {
    <span class='no'>server</span>$<span class='fu'>set_data</span>(<span class='st'>'cycles'</span>, <span class='no'>server</span>$<span class='fu'>get_data</span>(<span class='st'>'cycles'</span>) + <span class='fl'>1</span>)
})

<span class='co'># Count the number of requests</span>
<span class='no'>app</span>$<span class='fu'>on</span>(<span class='st'>'before-request'</span>, <span class='kw'>function</span>(<span class='no'>server</span>, <span class='no'>...</span>) {
    <span class='no'>server</span>$<span class='fu'>set_data</span>(<span class='st'>'visits'</span>, <span class='no'>server</span>$<span class='fu'>get_data</span>(<span class='st'>'visits'</span>) + <span class='fl'>1</span>)
})

<span class='co'># Handle requests</span>
<span class='no'>app</span>$<span class='fu'>on</span>(<span class='st'>'request'</span>, <span class='kw'>function</span>(<span class='no'>server</span>, <span class='no'>...</span>) {
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
        <span class='kw'>status</span> <span class='kw'>=</span> <span class='fl'>200L</span>,
        <span class='kw'>headers</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>'Content-Type'</span> <span class='kw'>=</span> <span class='st'>'text/html'</span>),
        <span class='kw'>body</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='st'>'This is indeed a test. You are number'</span>, <span class='no'>server</span>$<span class='fu'>get_data</span>(<span class='st'>'visits'</span>))
    )
})

<span class='co'># Show number of requests in the console</span>
<span class='no'>app</span>$<span class='fu'>on</span>(<span class='st'>'after-request'</span>, <span class='kw'>function</span>(<span class='no'>server</span>, <span class='no'>...</span>) {
    <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span>(<span class='no'>server</span>$<span class='fu'>get_data</span>(<span class='st'>'visits'</span>))
    <span class='fu'><a href='https://rdrr.io/r/utils/flush.console.html'>flush.console</a></span>()
})

<span class='co'># Terminate the server after 300 cycles</span>
<span class='no'>app</span>$<span class='fu'>on</span>(<span class='st'>'cycle-end'</span>, <span class='kw'>function</span>(<span class='no'>server</span>, <span class='no'>...</span>) {
    <span class='kw'>if</span> (<span class='no'>server</span>$<span class='fu'>get_data</span>(<span class='st'>'cycles'</span>) <span class='kw'>&gt;</span> <span class='fl'>300</span>) {
        <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span>(<span class='st'>'Ending...'</span>)
        <span class='fu'><a href='https://rdrr.io/r/utils/flush.console.html'>flush.console</a></span>()
        <span class='no'>server</span>$<span class='fu'>extinguish</span>()
    }
})

<span class='co'># Be polite</span>
<span class='no'>app</span>$<span class='fu'>on</span>(<span class='st'>'end'</span>, <span class='kw'>function</span>(<span class='no'>server</span>) {
    <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span>(<span class='st'>'Goodbye'</span>)
    <span class='fu'><a href='https://rdrr.io/r/utils/flush.console.html'>flush.console</a></span>()
})

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>app</span>$<span class='fu'>ignite</span>(<span class='kw'>showcase</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#initialization">Initialization</a></li>
      <li><a href="#fields">Fields</a></li>
      <li><a href="#methods">Methods</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://data-imaginist.com'>Thomas Lin Pedersen</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


